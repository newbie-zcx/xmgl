<div class="layui-card" style="height: 330px;">
    <div class="layui-row layui-card-header" style="background-color: #f2f2f2; height: 80px;">
        <div class="layui-col-md2" style="width: 64px;">
            <span class="big_font" style="display: table-cell;">提</span>
        </div>
        <div class="layui-col-md5">
            <div id="issue_title" class="layui-row" style="font-size: 24px; color: #333333">

            </div>
            <div class="layui-row">
                <div id="issue_name" class="layui-col-md6" style="font-size: 15px; color: #666666">

                </div>
                <div id="issue_time" class="layui-col-md6" style="font-size: 15px; color: #666666">

                </div>
            </div>
        </div>
        <div class="layui-col-md6">
        </div>
    </div>
    <div class="layui-card-body">
        <div id="issue_file_name" class="layui-row" style="font-size: 15px;"></div>
        <div id="issue_desc" class="layui-row" style="font-size: 15px; color: #454545"></div>
    </div>
</div>
<script>
  layui.use(['admin'], function () {
      var $ = layui.$;

      $(document).ready(function () {
          var issueId='${issueId}';
          issue_info(issueId);
          issue_file(issueId);
      });

      function issue_info(issueId) {
          /* 调用议政详情信息 */
          $.ajax({
              url: '/discuss/issue/detail/'+issueId,
              success: function (data) {
                  console.log(data);
                  $("#issue_title").text(data.title);
                  $("#issue_name").text(data.createName);
                  $("#issue_time").text(data.createDate);
                  $("#issue_desc").html(filterMessage(data.content));
              }
          });
      }

      function issue_file(issueId) {
          /* 调用议政附件信息 */
          $.ajax({
              url: '/discuss/issueFile/list/'+issueId,
              success: function (res) {
                  if("" == res){
                      $("#issue_file_name").append("无附件");
                  }else{
                      show_file(res.data);
                  }
              }
          });
      }

      /* 显示并预览附件 */
      function show_file(data) {
          for(var i=0; i<data.length; i++){
              var dv = data[i];
              var url = "http://127.0.0.1:8088/upload/xgsb/"+dv.filename;
              url = encodeURIComponent(url);
              var windowShow = 'http://127.0.0.1:8012/onlinePreview?url='+url;
              var windowShowBlank = "<a class='btn btn-default' style='font-size: 15px; color: #48b285' id='"+dv.id+"' target='_blank' href="+windowShow+">"+dv.sourceName+"</a>";
              $("#issue_file_name").append(windowShowBlank);
          }
      }

      <!-- 过滤特殊字符串 -->
      function filterMessage(value) {
          var regl = new RegExp("&lt;","g");
          var regg = new RegExp("&gt;","g");
          var regu = new RegExp("&quot;","g");
          value = value.replace(regl,"<");
          value = value.replace(regg,">");
          value = value.replace(regu,"");
          return value;
      };
  });
</script>
